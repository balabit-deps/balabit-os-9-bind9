Description: fix Dos via DNS-over-TLS queries
Origin: provided by ISC

diff --git a/lib/isc/netmgr/tlsdns.c b/lib/isc/netmgr/tlsdns.c
index 52c72e0fca..4af4289be3 100644
--- a/lib/isc/netmgr/tlsdns.c
+++ b/lib/isc/netmgr/tlsdns.c
@@ -1866,9 +1866,11 @@ tlsdns_send_direct(isc_nmsocket_t *sock, isc__nm_uvreq_t *req) {
 	}
 
 	result = tls_cycle(sock);
+	if (result != ISC_R_SUCCESS) {
+		return (result);
+	}
 
 requeue:
-
 	tlsdns_send_enqueue(sock, req);
 
 	return (result);
